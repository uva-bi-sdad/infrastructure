<<<<<<< HEAD
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27_100.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27_100")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
Sys.setenv(db_schema_name=db_schema_name)
library(readr)
library(stringr)
library(data.table)
dataplumbr::name.standard_col_names()
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27_1000.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27_1000")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
library(readr)
library(stringr)
library(data.table)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27_10000.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27_10000")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
library(readr)
library(stringr)
library(data.table)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
library(readr)
library(stringr)
library(data.table)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
db_schema_name
db_table_name
dt
DBI::dbDisconnect(con)
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
db_schema_name
library(readr)
library(stringr)
library(data.table)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Deed_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Deed_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
library(stringr)
v <- "34013||||Y|Y|TRD REALTY LLC|||LOLOS|RALPH|1||||||||||||||||||||||||||||||||20081120|89|Y|||METRO FNDG|||||20081003|LP||"
str_count(v, "\\|")
s <- '"FIPS"|"APN (Parcel Number) (unformatted)"|"PCL ID IRIS FORMATTED"|"APN SEQUENCE NUMBER"|"PENDING RECORD INDICATOR"|"CORPORATE INDICATOR"|"OWNER FULL NAME"|"OWNER 1 LAST NAME"|"OWNER 1 FIRST NAME & M I"|"OWNER 2 LAST NAME"|"OWNER 2 FIRST NAME & MI"|"OWNER ETAL INDICATOR"|"C/O NAME"|"OWNER RELATIONSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"PARTIAL INTEREST INDICATOR"|"ABSENTEE OWNER STATUS"|"PROPERTY LEVEL LATITUDE"|"PROPERTY LEVEL LONGITUDE"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS APARTMENT UNIT"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"MAILING HOUSE NUMBER PREFIX"|"MAILING HOUSE NUMBER"|"MAILING HOUSE NUMBER SUFFIX"|"MAILING DIRECTION"|"MAILING STREET NAME"|"MAILING MODE"|"MAILING QUADRANT"|"MAILING APARTMENT UNIT"|"MAILING PROPERTY CITY"|"MAILING PROPERTY STATE"|"MAILING PROPERTY ADDRESS ZIP CODE"|"MAILING CARRIER CODE"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN"|"SELLER LAST NAME"|"SELLER FIRST NAME"|"SELLER NAME 1"|"SELLER NAME 2"|"SALE CODE"|"SALE AMOUNT"|"SALE DATE (YYYYMMDD)"|"RECORDING DATE (YYYYMMDD)"|"DOCUMENT TYPE"|"TRANSACTION TYPE"|"DOCUMENT NUMBER"|"BOOK/PAGE (6x6)"|"LENDER FULL NAME"|"LENDER LAST NAME"|"LENDER FIRST NAME"|"LENDER ADDRESS"|"LENDER CITY"|"LENDER ST"|"LENDER ZIP"|"LENDER COMPANY CODE"|"TITLE COMPANY NAME"|"TITLE COMPANY CODE"|"MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE INTEREST RATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTGAGE ASSUMPTION AMOUNT"|"MTG SEQ NUMBER"|"PRI-CAT-CODE"|"MTG SEC CAT CODES 1X10"|"DEED SEC CAT CODES 2X10"|"OWNERSHIP TRANSFER PERCENTAGE"|"LAND USE"|"PROPERTY INDICATOR"|"SELLER CARRY BACK"|"INTER FAMILY"|"PRIVATE PARTY LENDER"|"MORTGAGE INTEREST RATE TYPE"|"CONSTRUCTION LOAN"|"RESALE/NEW CONSTRUCTION"|"FORECLOSURE"|"CASH/MORTGAGE PURCHASE"|"EQUITY FLAG"|"REFI FLAG"|"RESIDENTIAL MODEL INDICATOR"|"ADD/CHANGE FIELD"|"FILLER"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"BUILDING  SQUARE FEET"|"LIVING SQUARE FEET"|"GROSS SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL BATHS"'
str_count(s, "\\|")
x <- '"34013"|"0200362000000011"|"02-00362-0000-00011"|"1"|""|"Y"|"TRD REALTY LLC"|""|""|"LOLOS"|"RALPH"|"1"|""|""|""|""|""|"40.781789"|"-74.190544"|""|""|""|""|"BLOOMFIELD"|"AVE"|""|""|"BLOOMFIELD"|"NJ"|"070035621"|"C026"|""|""|""|""|""|""|""|""|""|""|""|""|"20081120"|"90"|"Y"|""|""|"METRO FNDG"|""|""|""|""|"20081003"|"LP"|""|"8090908"|"012160009386"|""|""|""|""|""|""|""|""|"ATTORNEY ONLY"|"00400"|"300000.00"|"20080521"|""|""|""|""|""|""|""|""|"F"|""|""|""|"200"|"20"|""|"False"|"0"|""|"0"|""|""|""|""|""|""|""|""|"200000"|"169900"|"30100"|"10900.00"|"2007"|"2008"|""|""|".3100"|"13503.6000"|""|""|""|"1922"|""|""|""'
str_count(x, "\\|")
library(readr)
library(stringr)
library(data.table)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Current_Tax_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Current_Tax_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
library(dataplumbr)
library(readr)
library(stringr)
library(data.table)
library(dataplumbr)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Current_Tax_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Current_Tax_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL BATHS"|"FULL BATHS"|"HALF BATHS"|"1QTR BATHS"|"3QTR BATHS"|"BATH FIXTURES"|"AIR CONDITIONING"|"BASEMENT FINISH"|"BASEMENT TYPE CODE"|"BLDG CODE"|"BLDG IMPV CODE"|"CONDITION"|"CONSTRUCTION TYPE"|"EXTERIOR WALLS"|"FIREPLACE IND"|"FIREPLACE NUMBER"|"FIREPLACE TYPE"|"FOUNDATION"|"FLOOR"|"FRAME"|"GARAGE"|"HEATING"|"PARKING SPACES"|"PARKING TYPE"|"POOL"|"POOL CODE"|"QUALITY"|"ROOF COVER"|"ROOF TYPE"|"STORIES CODE"|"STORIES NUMBER"|"STYLE"|"VIEW"|"LOCATION INFLUENCE"|"NUMBER OF UNITS"|"UNITS NUMBER"|"ELECTRIC/ENERGY"|"FUEL"|"SEWER"|"UTILITIES"|"WATER"|"LEGAL1"|"LEGAL2"|"LEGAL3"'
''
'
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL BATHS"|"FULL BATHS"|"HALF BATHS"|"1QTR BATHS"|"3QTR BATHS"|"BATH FIXTURES"|"AIR CONDITIONING"|"BASEMENT FINISH"|"BASEMENT TYPE CODE"|"BLDG CODE"|"BLDG IMPV CODE"|"CONDITION"|"CONSTRUCTION TYPE"|"EXTERIOR WALLS"|"FIREPLACE IND"|"FIREPLACE NUMBER"|"FIREPLACE TYPE"|"FOUNDATION"|"FLOOR"|"FRAME"|"GARAGE"|"HEATING"|"PARKING SPACES"|"PARKING TYPE"|"POOL"|"POOL CODE"|"QUALITY"|"ROOF COVER"|"ROOF TYPE"|"STORIES CODE"|"STORIES NUMBER"|"STYLE"|"VIEW"|"LOCATION INFLUENCE"|"NUMBER OF UNITS"|"UNITS NUMBER"|"ELECTRIC/ENERGY"|"FUEL"|"SEWER"|"UTILITIES"|"WATER"|"LEGAL1"|"LEGAL2"|"LEGAL3"'
'
'
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL BATHS"|"FULL BATHS"|"HALF BATHS"|"1QTR BATHS"|"3QTR BATHS"|"BATH FIXTURES"|"AIR CONDITIONING"|"BASEMENT FINISH"|"BASEMENT TYPE CODE"|"BLDG CODE"|"BLDG IMPV CODE"|"CONDITION"|"CONSTRUCTION TYPE"|"EXTERIOR WALLS"|"FIREPLACE IND"|"FIREPLACE NUMBER"|"FIREPLACE TYPE"|"FOUNDATION"|"FLOOR"|"FRAME"|"GARAGE"|"HEATING"|"PARKING SPACES"|"PARKING TYPE"|"POOL"|"POOL CODE"|"QUALITY"|"ROOF COVER"|"ROOF TYPE"|"STORIES CODE"|"STORIES NUMBER"|"STYLE"|"VIEW"|"LOCATION INFLUENCE"|"NUMBER OF UNITS"|"UNITS NUMBER"|"ELECTRIC/ENERGY"|"FUEL"|"SEWER"|"UTILITIES"|"WATER"|"LEGAL1"|"LEGAL2"|"LEGAL3"'
"
'
stringr::str_count(t, "\\"")
)
"
stringr::str_count(t, "\"")
stringr::str_match(t, "\\|\\"")
"
stringr::str_match(t, "\|\"")
stringr::str_match(t, "\\|")
stringr::str_match(t, "\\"")
"
stringr::str_match(t, '\\"')
stringr::str_match(t, '\\|\\"')
stringr::str_match(t, '\\|\\"[A-Z0-9\\.]*?\\"\\|')
stringr::str_match(t, '\\|\\"[A-Z0-9\\.]*?\\"[A-Z0-9\\.]+\\"\\|')
t
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTALBATHS"|"FULL BATHS"|"HALF BATHS"|"1QTR BATHS"|"3QTR BATHS"|"BATH FIXTURES"|"AIR CONDITIONING"|"BASEMENT FINISH"|"BASEMENT TYPE CODE"|"BLDG CODE"|"BLDG IMPV CODE"|"CONDITION"|"CONSTRUCTION TYPE"|"EXTERIOR WALLS"|"FIREPLACE IND"|"FIREPLACE NUMBER"|"FIREPLACE TYPE"|"FOUNDATION"|"FLOOR"|"FRAME"|"GARAGE"|"HEATING"|"PARKING SPACES"|"PARKING TYPE"|"POOL"|"POOL CODE"|"QUALITY"|"ROOF COVER"|"ROOF TYPE"|"STORIES CODE"|"STORIES NUMBER"|"STYLE"|"VIEW"|"LOCATION INFLUENCE"|"NUMBER OF UNITS"|"UNITS NUMBER"|"ELECTRIC/ENERGY"|"FUEL"|"SEWER"|"UTILITIES"|"WATER"|"LEGAL1"|"LEGAL2"|"LEGAL3"'
'
t
stringr::str_match(t, "LEGAL")
stringr::str_match_all(t, "BATH")
stringr::str_match_all(t, "TOTAL BATH")
stringr::str_match_all(t, "TOTAL BATHS")
stringr::str_match_all(t, "....TOTAL BATHS....")
stringr::str_match_all(t, "....TOTAL BATHS...........")
stringr::str_match_all(t, "....TOTAL BATHS............................")
stringr::str_match_all(t, "....TOTAL BATHS.......................")
stringr::str_match_all(t, "....TOTAL BATHS..................")
stringr::str_match_all(t, "....TOTAL BATHS...................")
stringr::str_match_all(t, "....TOTAL BATHS....................")
stringr::str_match_all(t, "....TOTAL BATHS.....................")
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL'
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL '
'
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTAL'
t <- '"08041"|"3600000135"|"1"|"36000-00-135"|"3600000135"|""|"36000-00-135"|""|"63-00-16"|""|"0046022041"|""|"39"|"63"|"16"|""|""|""|"137"|"1135"|""|"Y"|"A-35"|"10"|"HANOVER SCHOOL NO 28"|"08041HA002"|""|"F5"|"167"|"SQUIRREL CREEK ESTATES FIL 2"|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|"38.654099"|"-104.473231"|"38.650794"|"-104.473547"|""|"DE"|"ANGEL OFELIA U"|""|""|"O"|""|""|""|""|""|"18960"|""|""|""|"HOLMAN"|"RD"|""|""|"COLORADO SPRINGS"|"CO"|"809289654"|"R002"|""|"50600"|"50600"|""|"M"|"M"|"M"|"3620"|"3620"|""|"50600"|"50600"|""|""|""|""|"206.13"|"2018"|"20190000"|"NB2"|"20030113"|"12"|""|"223215"|""|"WD"|"20021217"|"20021119"|"70000.00"|""|"MOTT CARL H TRUST"|"1"|"00009"|"STEWART TITLE"|"Y"|"15000.00"|"20021119"|"PP"|"TR"|"Y"|"3"|"20060215"|""|"006329"|"MOTT CARL H TRUST (TR)"|""|""|""|"19100101"|"7712"|""|""|"DD"|""|"19980420"|""|""|"1"|""|""|""|"35.0200"|"1525471"|"1344"|"B"|"1344"|""|""|""|""|""|""|"1994"|""|""|""|""|""|""|""|""|""|""|""|""|""|"RM0"|"RM0"|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|""|"1.00"|""|""|""|"1"|""|""|""|""|""|""|"TRACT 39 SQUIRREL CREEK ESTATES FIL NO 2  "|""|""FIPS CODE"|"UNFORMATTED APN"|"APN SEQUENCE NBR"|"FORMATTED APN"|"ORIGINAL APN"|"PREVIOUS PARCEL NUMBER"|"P-ID-IRIS-FRMTD"|"ACCOUNT NUMBER"|"MAP REFERENCE1"|"MAP REFERENCE2"|"CENSUS TRACT"|"BLOCK NUMBER"|"LOT NUMBER"|"RANGE"|"TOWNSHIP"|"SECTION"|"QUARTER SECTION"|"FLOOD ZONE COMMUNITY PANEL ID"|"LAND USE"|"COUNTY USE 1"|"COUNTY USE 2"|"MOBILE HOME IND"|"ZONING"|"PROPERTY INDICATOR"|"MUNICIPALITY NAME"|"MUNICIPALITY CODE"|"SUBDIVISION TRACT NUMBER"|"SUBDIVISION PLAT BOOK"|"SUBDIVISION PLAT PAGE"|"SUBDIVISION NAME"|"SITUS HOUSE NUMBER PREFIX"|"SITUS HOUSE NUMBER"|"SITUS HOUSE NUMBER #2"|"SITUS HOUSE NUMBER SUFFIX"|"SITUS DIRECTION"|"SITUS STREET NAME"|"SITUS MODE"|"SITUS QUADRANT"|"SITUS UNIT NUMBER"|"SITUS CITY"|"SITUS STATE"|"SITUS ZIP CODE"|"SITUS CARRIER CODE"|"PROPERTY CENTROID LONGITUDE"|"PROPERTY CENTROID LATITUDE "|"BLOCK LEVEL LATITUDE"|"BLOCK LEVEL LONGITUDE"|"OWNER CORPORATE INDICATOR"|"OWNER1 LAST NAME"|"OWNER1 FIRST NAME & MI"|"OWNER2 LAST NAME"|"OWNER2 FIRST NAME & MI"|"ABSENTEE OWNER STATUS"|"HOMESTEAD EXEMPT"|"OWNER ETAL INDICATOR"|"OWNER OWNERSHIP RIGHTS CODE"|"OWNER RELATIONSHIP TYPE"|"MAIL HOUSE NUMBER PREFIX"|"MAIL HOUSE NUMBER"|"MAIL HOUSE NUMBER #2"|"MAIL HOUSE NUMBER SUFFIX"|"MAIL DIRECTION"|"MAIL STREET NAME"|"MAIL MODE"|"MAIL QUADRANT"|"MAIL UNIT NUMBER"|"MAIL CITY"|"MAIL STATE"|"MAIL ZIP CODE"|"MAIL CARRIER CODE"|"MAILING OPT-OUT CODE"|"TOTAL VALUE CALCULATED"|"LAND VALUE CALCULATED"|"IMPROVEMENT VALUE CALCULATED"|"TOTAL VALUE CALCULATED IND"|"LAND VALUE CALCULATED IND"|"IMPROVEMENT VALUE CALCULATED IND"|"ASSD TOTAL VALUE"|"ASSD LAND VALUE"|"ASSD IMPROVEMENT VALUE"|"MKT TOTAL VALUE"|"MKT LAND VALUE"|"MKT IMPROVEMENT VALUE"|"APPR TOTAL VALUE"|"APPR LAND VALUE"|"APPR IMPROVEMENT VALUE"|"TAX AMOUNT"|"TAX YEAR"|"ASSESSED YEAR"|"TAX CODE AREA"|"BATCH-ID"|"BATCH-SEQ"|"MULTI APN FLAG"|"DOCUMENT NO."|"BOOK & PAGE"|"DOCUMENT TYPE"|"RECORDING DATE"|"SALE DATE"|"SALE PRICE"|"SALE CODE"|"SELLER NAME"|"TRANSACTION TYPE"|"TITLE COMPANY CODE"|"TITLE COMPANY NAME"|"RESIDENTIAL MODEL INDICATOR"|"1st MORTGAGE AMOUNT"|"MORTGAGE DATE"|"MORTGAGE LOAN TYPE CODE"|"MORTGAGE DEED TYPE"|"MORTGAGE TERM CODE"|"MORTGAGE TERM"|"MORTGAGE DUE DATE"|"MORTAGE ASSUMPTION AMOUNT"|"LENDER CODE"|"LENDER NAME"|"2nd MORTGAGE AMOUNT"|"2nd MORTGAGE LOAN TYPE CODE"|"2ND MORTGAGE DEED TYPE"|"PRIOR BATCH-ID"|"PRIOR BATCH-SEQ"|"PRIOR DOCUMENT NO"|"PRIOR BOOK & PAGE"|"PRIOR DOCUMENT TYPE"|"PRIOR RECORDING DATE"|"RIOR SALE DATE"|"PRIOR SALE PRICE "|"PRIOR SALE CODE"|"PRIOR SALES TRANSACTION TYPE"|"PRIOR MORTGAGE AMOUNT"|"FRONT FOOTAGE"|"DEPTH FOOTAGE"|"ACRES"|"LAND SQUARE FOOTAGE"|"UNIVERSAL BUILDING SQUARE FEET"|"BUILDING SQUARE FEET IND"|"BUILDING SQUARE FEET"|"LIVING SQUARE FEET"|"GROUND FLOOR SQUARE FEET"|"GROSS SQUARE FEET"|"ADJUSTED GROSS SQUARE FEET"|"BASEMENT SQUARE FEET"|"GARAGE/PARKING SQUARE FEET"|"YEAR BUILT"|"EFFECTIVE YEAR BUILT"|"BEDROOMS"|"TOTAL ROOMS"|"TOTAL BATHS CALCULATED"|"TOTALBATHS'
'
db_col_names
db_col_names[1:188]
db_col_names <- db_col_names[1:188]
dt <- data.table(V1="")
library(readr)
library(stringr)
library(data.table)
library(dataplumbr)
col_delim <- "|"
#col_num <- 145
#col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/Corelogic_USDA_Current_Tax_2020_06_27.txt"
first_line <- readLines(file_path, n = 1)
col_delim_num <- stringr::str_count(first_line, "\\|")
col_num <- col_delim_num + 1
db_schema_name <- "corelogic_usda"
db_table_name <- tolower("Corelogic_USDA_Current_Tax_2020_06_27")
db_col_names <- dataplumbr::name.standard_col_names(stringr::str_split(first_line, "\\|")[[1]]) %>%
stringr::str_replace("^_", "") %>%
stringr::str_replace("_$", "")
db_col_names <- db_col_names[1:188]
dt <- data.table(V1="")
for (n in db_col_names) {
dt[, eval(n) := ""]
}
dt[, V1 := NULL]
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
no_quote_path <- paste0(tools::file_path_sans_ext(ascii_path), "_noqt.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(no_quote_path=no_quote_path)
Sys.setenv(db_schema_name=db_schema_name)
Sys.setenv(db_table_name=db_table_name)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
source("db_connection.R")
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
file_paths <- list.files("/project/biocomplexity/sdad/projects_data/usda/bb/original/Corelogic_June_2020_Files/", pattern = "^x", full.names = T)
file_paths
insert_into_db_table <- function(
file_path,
schema_name,
table_name,
expected_col_cnt
) {
dt <- data.table::fread(file_path)
col_cnt <- ncol(dt)
if (col_cnt == expected_col_cnt) {
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, overwrite=T, row.names=F)
DBI::dbDisconnect(con)
print("OK")
} else {
print(paste("WRONG NUMBER OF COLUMNS FOR FILE:", file_path))
}
}
get_db_conn <-
function(db_name = "sdad",
db_host = "postgis1",
db_port = "5432",
db_user = Sys.getenv("db_usr"),
db_pass = Sys.getenv("db_pwd")) {
RPostgreSQL::dbConnect(
drv = RPostgreSQL::PostgreSQL(),
dbname = db_name,
host = db_host,
port = db_port,
user = db_user,
password = db_pass
)
}
insert_into_db_table <- function(
file_path,
schema_name,
table_name,
expected_col_cnt
) {
dt <- data.table::fread(file_path)
col_cnt <- ncol(dt)
if (col_cnt == expected_col_cnt) {
con <- get_db_conn()
DBI::dbWriteTable(con, c(db_schema_name, db_table_name), dt, row.names=F, append = T)
DBI::dbDisconnect(con)
print("OK")
} else {
print(paste("WRONG NUMBER OF COLUMNS FOR FILE:", file_path))
}
}
tolower("Corelogic_USDA_Current_Tax_2020_06_27")
for (f in file_paths) {
insert_into_db_table(f, "corelogic_usda", "corelogic_usda_current_tax_2020_06_27", 188)
}
insert_into_db_table <- function(
file_path,
schema_name,
table_name,
expected_col_cnt
) {
dt <- data.table::fread(file_path)
col_cnt <- ncol(dt)
if (col_cnt == expected_col_cnt) {
con <- get_db_conn()
RPostgreSQL::dbWriteTable(con, c(db_schema_name, db_table_name), dt, row.names=F, append = T)
DBI::dbDisconnect(con)
print("OK")
} else {
print(paste("WRONG NUMBER OF COLUMNS FOR FILE:", file_path))
}
}
for (f in file_paths) {
insert_into_db_table(f, "corelogic_usda", "corelogic_usda_current_tax_2020_06_27", 188)
}
length(db_col_names)
insert_into_db_table <- function(
file_path,
schema_name,
table_name,
col_names
) {
dt <- data.table::fread(file_path)
colnames(dt) <- col_names
col_cnt <- ncol(dt)
if (col_cnt == length(col_names)) {
con <- get_db_conn()
RPostgreSQL::dbWriteTable(con, c(db_schema_name, db_table_name), dt, row.names=F, append = T)
DBI::dbDisconnect(con)
print("OK")
} else {
print(paste("WRONG NUMBER OF COLUMNS FOR FILE:", file_path))
}
}
col_names <- db_col_names
insert_into_db_table <- function(
file_path,
schema_name,
table_name,
col_names
) {
dt <- data.table::fread(file_path)
colnames(dt) <- col_names
col_cnt <- ncol(dt)
if (col_cnt == length(col_names)) {
con <- get_db_conn()
RPostgreSQL::dbWriteTable(con, c(db_schema_name, db_table_name), dt, row.names=F, append = T)
DBI::dbDisconnect(con)
print("OK")
} else {
print(paste("WRONG NUMBER OF COLUMNS FOR FILE:", file_path))
}
}
for (f in file_paths) {
insert_into_db_table(f, "corelogic_usda", "corelogic_usda_current_tax_2020_06_27", col_names)
}
warnings()
ir <- iris
class(ir)
ir[1:3]
ir[1:3,]
=======
host = db_host,
port = db_port,
user = db_user,
password = db_pass)
DBI::dbExecute(con, paste0("GRANT ALL ON DATABASE ", grant_database," TO ", grant_username))
print(paste0("GRANT ALL ON DATABASE ", grant_database," TO ", grant_username))
DBI::dbExecute(con, paste0("GRANT ALL ON SCHEMA ", schema," TO ", grant_username))
print(paste0("GRANT ALL ON SCHEMA ", schema," TO ", grant_username))
DBI::dbExecute(con, paste0("GRANT ALL ON ALL TABLES IN SCHEMA ", schema," TO ", grant_username))
print(paste0("GRANT ALL ON ALL TABLES IN SCHEMA ", schema," TO ", grant_username))
DBI::dbExecute(con, paste0("ALTER DEFAULT PRIVILEGES IN SCHEMA ", schema," GRANT ALL ON TABLES TO ", grant_username))
print(paste0("ALTER DEFAULT PRIVILEGES IN SCHEMA ", schema," GRANT ALL ON TABLES TO ", grant_username))
DBI::dbExecute(con, paste0("ALTER DEFAULT PRIVILEGES IN SCHEMA ", schema," GRANT ALL ON SEQUENCES TO ", grant_username))
print(paste0("ALTER DEFAULT PRIVILEGES IN SCHEMA ", schema," GRANT ALL ON SEQUENCES TO ", grant_username))
DBI::dbDisconnect(con)
}
grant_db_permissions("ghtorrent_restore", "jbs3hp", db_host = "postgis_2")
# DB Functions
source("db/src/db_create_user.R")
source("db/src/db_grant_permissions.R")
# CREATE DB ACCOUNTS ----
# SDAD Staff
db_users_sdad <- data.table::fread("db/src/users_sdad.csv")[, uid]
db_users_dspg2019 <- data.table::fread("db/src/users_dspg2019.csv")[, uid]
# All Users
db_users <- c(db_users_dspg2019, db_users_sdad)
# Create users
source("db/src/db_create_user.R")
# Create users
source("db/src/db_create_user.R")
for (dbu in db_users) {
create_db_user(dbu, db_host = "postgis_2")
}
# Grant all permissions on grant_database to grant_user
source("db/src/db_grant_permissions.R")
# Grant all permissions on grant_database to grant_user
source("db/src/db_grant_permissions.R")
for (dbu in db_users) {
grant_db_permissions(grant_username = dbu, grant_database = "gis", schema = "census_cb", db_host = "postgis_2")
}
for (dbu in db_users) {
grant_db_permissions(grant_username = dbu, grant_database = "ghtorrent_restore", schema = "public", db_host = "postgis_2")
}
for (dbu in db_users) {
grant_db_permissions(grant_username = dbu, grant_database = "corelogic", schema = "public", db_host = "postgis_2")
}
# DB Functions
source("db/src/db_create_user.R")
source("db/src/db_grant_permissions.R")
grant_db_permissions("kb7hp", "ghtorrent_restore", schema = "public", db_host = "postgis_2")
grant_db_permissions(grant_username = "kb7hp", grant_database = "ghtorrent_restore", schema = "public", db_host = "postgis_2")
# DB Functions
source("db/src/db_create_user.R")
source("db/src/db_grant_permissions.R")
grant_db_permissions(grant_username = "jbs3hp", grant_database = "burning_glass", schema = "public", db_host = "postgis_2")
grant_db_permissions(grant_username = "dtn2ep", grant_database = "burning_glass", schema = "public", db_host = "postgis_2")
grant_db_permissions(grant_username = "nr3xe", grant_database = "burning_glass", schema = "public", db_host = "postgis_2")
grant_db_permissions(grant_username = "sc2pg", grant_database = "burning_glass", schema = "public", db_host = "postgis_2")
# DB Functions
source("db/src/db_create_user.R")
source("db/src/db_grant_permissions.R")
grant_db_permissions(grant_username = "kb7hp", grant_database = "ghtorrent_restore", schema = "public", db_host = "postgis_2")
source("db/src/db_grant_permissions.R")
grant_db_permissions(grant_username = "dtn2ep", grant_database = "gis", schema = "census_cb", db_host = "postgis_1")
grant_db_permissions(grant_username = "dtn2ep", grant_database = "gis", schema = "census_tl", db_host = "postgis_1")
# EXTERNAL Staff
db_users_sdad <- data.table::fread("db/src/users_external.csv")[, uid]
db_users_sdad
db_users_sdad <- data.table::fread("db/src/users_sdad.csv")[, uid]
# EXTERNAL Staff
db_users_external <- data.table::fread("db/src/users_external.csv")[, uid]
# DSPG Students
db_users_dspg2019 <- data.table::fread("db/src/users_dspg2019.csv")[, uid]
# All Users
db_users <- c(db_users_sdad, db_users_external, db_users_dspg2019)
groups <- jsonlite::read_json("db/data/projects.json")
groups
projects <- jsonlite::read_json("db/data/projects.json")
length(projects)
for (i in 1:length(projects)) {
print(projects[i])
}
for (i in 1:length(projects)) {
print(projects[[i]])
}
for (i in 1:length(projects)) {
print(projects[1])
}
for (i in 1:length(projects)) {
print(projects[i][1])
}
projects[1]
projects[1][1]
projects[[1]]
projects[[1]][1]
projects[[1]][[1]]
projects[[1]]$project
for (i in 1:length(projects)) {
print(projects[[i]]$project)
}
projects[[1]]$members
projects[[1]]$members[1]
projects[[1]]$members[[1]]
for (i in 1:length(projects)) {
project_name <- projects[[i]]$project
print(project_name)
for (j in 1:length(projects[[i]]$members)) {
print(projects[[i]]$members[[j]])
}
}
for (i in 1:length(projects)) {
for (j in 1:length(projects[[i]]$members)) {
print(projects[[i]]$project)
print(projects[[i]]$members[[j]])
}
}
for (i in 1:length(projects)) {
print(projects[[i]]$project)
for (j in 1:length(projects[[i]]$members)) {
print(projects[[i]]$members[[j]])
}
}
source("db/src/db_connection.R")
con <- get_db_conn()
for (i in 1:length(projects)) {
group <- projects[[i]]$project
create_group_sql <- paste0("CREATE GROUP ", group)
DBI::dbSendQuery(con, create_group_sql)
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbSendQuery(con, assign_group_sql)
}
}
con <- get_db_conn()
for (i in 1:length(projects)) {
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbSendQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
DBI::dbSendQuery(con, create_group_sql)
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbSendQuery(con, assign_group_sql)
}
}
DBI::dbDisconnect(con)
con <- get_db_conn()
for (i in 1:length(projects)) {
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbGetQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
DBI::dbGetQuery(con, create_group_sql)
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
if (user_exists_sql != 1) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
}
}
DBI::dbDisconnect(con)
i=1
j=1
projects <- jsonlite::read_json("db/data/projects.json")
con <- get_db_conn()
user <- projects[[i]]$members[[j]]
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
View(user_exists)
user_exists
user_exists[, 1]
if (user_exists[, 1] != 1) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
if (user_exists[, 1] != 1) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
}
con <- get_db_conn()
for (i in 1:length(projects)) {
# DROP (IF EXISTS) AND CREATE DB GROUP
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbGetQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
DBI::dbGetQuery(con, create_group_sql)
# ASSIGN USERS TO DB GROUP
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
# CREATE USER IF NOT EXISTS
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
if (user_exists[, 1] != 1) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
# ASSIGN USER TO GROUP
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
}
}
DBI::dbDisconnect(con)
con <- get_db_conn()
user_exists <- DBI::dbGetQuery(con, "select 1 from pg_roles where rolename='booboo'")
user_exists <- DBI::dbGetQuery(con, "select 1 from pg_roles where rolname='booboo'")
nrow(user_exists)
DBI::dbDisconnect(con)
con <- get_db_conn()
for (i in 1:length(projects)) {
# DROP (IF EXISTS) AND CREATE DB GROUP
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbGetQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
DBI::dbGetQuery(con, create_group_sql)
# ASSIGN USERS TO DB GROUP
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
# CREATE USER IF NOT EXISTS
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
if (nrow(user_exists) == 0) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
# ASSIGN USER TO GROUP
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
}
}
DBI::dbDisconnect(con)
con <- get_db_conn()
t <- DBI::dbGetQuery(con, "create group testgroup1")
t
t <- DBI::dbGetQuery(con, "create group testgroup1")
t
con <- get_db_conn()
t <- DBI::dbSendQuery(con, "create group testgroup1")
t
t
t <- DBI::dbSendQuery(con, "drop group testgroup1")
t <- DBI::dbSendQuery(con, "create group testgroup1")
t
t <- DBI::dbSendQuery(con, "drop group testgroup1")
t <- DBI::dbGetQuery(con, "create group testgroup1")
t
View(t)
is.null(t)
t <- DBI::dbSendQuery(con, "drop group testgroup1")
t <- DBI::dbSendQuery(con, "create group testgroup1")
is.null(t)
t
t <- DBI::dbSendQuery(con, "create group testgroup1")
is.null(t)
t
t <- DBI::dbSendQuery(con, "drop group testgroup1")
t <- DBI::dbGetQuery(con, "create group testgroup1")
t <- DBI::dbGetQuery(con, "create group testgroup1")
t
con <- get_db_conn()
for (i in 1:length(projects)) {
# DROP (IF EXISTS) AND CREATE DB GROUP
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbGetQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
create_group_result <- DBI::dbGetQuery(con, create_group_sql)
if (is.null(create_group_result) == TRUE) {
print("PROBLEM WITH CREATE GROUP")
} else {
print(paste0("Creation of group ", group, " successful!"))
}
# ASSIGN USERS TO DB GROUP
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
# CREATE USER IF NOT EXISTS
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
if (nrow(user_exists) == 0) {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
DBI::dbGetQuery(con, create_user_sql)
}
# ASSIGN USER TO GROUP
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
DBI::dbGetQuery(con, assign_group_sql)
}
}
DBI::dbDisconnect(con)
source("db/src/db_connection.R")
projects <- jsonlite::read_json("db/data/projects.json")
con <- get_db_conn()
for (i in 1:length(projects)) {
# DROP (IF EXISTS) AND CREATE DB GROUP
group <- projects[[i]]$project
drop_group_sql <- paste0("DROP GROUP IF EXISTS ", group)
DBI::dbGetQuery(con, drop_group_sql)
create_group_sql <- paste0("CREATE GROUP ", group)
create_group_result <- DBI::dbGetQuery(con, create_group_sql)
if (is.null(create_group_result) == TRUE) {
print("PROBLEM WITH CREATE GROUP")
} else {
print(paste0("Creation of group ", group, " successful!"))
}
# ASSIGN USERS TO DB GROUP
for (j in 1:length(projects[[i]]$members)) {
user <- projects[[i]]$members[[j]]
# CREATE USER IF NOT EXISTS
user_exists_sql <- paste0("SELECT 1 FROM pg_roles WHERE rolname='", user, "'")
user_exists <- DBI::dbGetQuery(con, user_exists_sql)
if (nrow(user_exists) > 0) {
print(paste0("User ", user, " already exists."))
} else {
create_user_sql <- paste0("CREATE USER ", user," WITH PASSWORD '", user, "'")
create_user_result <- DBI::dbGetQuery(con, create_user_sql)
if (is.null(create_group_result) == TRUE) {
print("PROBLEM WITH CREATE USER")
} else {
print(paste0("Creation of user ", user, " successful!"))
}
}
# ASSIGN USER TO GROUP
assign_group_sql <- paste0("GRANT ", group, " TO ", user)
assign_group_result <- DBI::dbGetQuery(con, assign_group_sql)
if (is.null(assign_group_result) == TRUE) {
print("PROBLEM WITH ASSIGN USER")
} else {
print(paste0("User ", user, " assigned to group ", group))
}
}
}
DBI::dbDisconnect(con)
source("db/src/db_connection.R")
projects <- jsonlite::read_json("db/data/projects.json")
projects <- jsonlite::read_json("db/data/projects.json")
k=1
schema <- projects[[i]]$schemas[[k]]
# CREATE SCHEMA IF NOT EXISTS
schema_create_sql <- paste0("CREATE SCHEMA IF NOT EXISTS ", schema)
create_schema_result <- DBI::dbGetQuery(con, schema_create_sql)
con <- get_db_conn()
create_schema_result <- DBI::dbGetQuery(con, schema_create_sql)
# ASSIGN PERMISSIONS
schema_permissions_sql <- paste0("GRANT ALL ON SCHEMA ", schema, " TO ", group)
schema_permissions_result <- DBI::dbGetQuery(con, schema_permissions_sql)
schema_table_permissions_sql <- paste0("GRANT ALL ON ALL TABLES IN SCHEMA ", schema, " TO ", group)
schema_table_permissions_result <- DBI::dbGetQuery(con, schema_table_permissions_sql)
v <- "`08001`|`R0063935`|`1`|`R0063935`|`R0063935`|``|`R0063935`|`R0063935`|`223-K`|``|`0096031015`|`2`|`3`|`68W`|`02S`|`31`|`NE`|``|`163`|`1212`|``|``|``|`10`|``|``|``|``|``|`VALENTES`|``|`4032`|``|``|`W`|`77TH`|`PL`|``|``|`WESTMINSTER`|`CO`|`800304501`|`C028`|``|`RAMIREZ`|`SANTIAGO`|``|``|`A`|``|``|``|``|``|`10456`|``|``|``|`URA`|`LN`|``|``|`NORTHGLENN`|`CO`|`802343646`|`C051`|``|`150966`|`30000`|`120966`|`M`|`M`|`M`|`12020`|`2390`|`9630`|`150966`|`30000`|`120966`|``|``|``|`1179.64`|`2011`|`20120000`|`555`|`60.0000`|`110.0000`|`.1500`|`6600`|`1814`|`L`|`1998`|`1814.00`|`1414.00`|``|`1814.00`|``|`184.00`|`1953`|`1975`|`4`|`6`|`2.00`|`2.00`|``|``|``|``|``|`ACE`|``|``|`R00`|``|`AVE`|`FRY`|`FMV`|``|``|``|``|``|``|`450`|`FA0`|``|``|``|``|`QAV`|`015`|`I00`|``|`2.00`|`000`|``|``|`1`|``|``|``|``|``|``|`SUB:VALENTES SUBD BLK:2 LOT:3`|``|``"
stringr::str_count(v, "|")
v
stringr::str_count(v, "8")
stringr::str_count(v, "\\|")
x <- "`08001`|`R0005862`|`1`|`R0005862`|`R0005862`|``|`R0005862`|`R0005862`|`138-Q`|``|`0086051017`|`6`|`12`|`66W`|`01S`|`08`|`NW`|``|`163`|`1212`|``|``|``|`10`|``|``|``|``|``|`SHERATON PARK AMD`|``|`151`|``|``|`S`|`16TH AVENUE`|`DR`|``|``|`BRIGHTON`|`CO`|`806012311`|`C008`|``|`HUSS`|`MARK A`|`HUSS`|``|`O`|``|``|`JT`|``|``|`151`|``|``|`S`|`16TH AVENUE`|`DR`|``|``|`BRIGHTON`|`CO`|`806012311`|`C008`|``|`159437`|`31000`|`128437`|`M`|`M`|`M`|`12690`|`2470`|`10220`|`159437`|`31000`|`128437`|``|``|``|`1207.60`|`2011`|`20120000`|`316`|`70.0000`|`110.0000`|`.1800`|`7700`|`2072`|`L`|`3668`|`2072.00`|`1092.00`|``|`2184.00`|`1092.00`|`392.00`|`1962`|`1962`|`3`|`5`|`2.00`|`2.00`|``|``|``|``|``|`ACE`|`FFI`|`001`|`R00`|``|`AVE`|`FRY`|`FMV`|`Y`|`1`|`1U0`|``|``|``|`450`|`FA0`|``|``|``|``|`QAV`|`015`|`G00`|``|`1.00`|`000`|``|``|`1`|``|``|``|``|``|``|`SUB:SHERATON PARK AMENDED BLK:6 LOT:12`|``|``"
stringr::str_count(x, "\\|")
v <- "`08001`|`R0063935`|`1`|`R0063935`|`R0063935`|``|`R0063935`|`R0063935`|`223-K`|``|`0096031015`|`2`|`3`|`68W`|`02S`|`31`|`NE`|``|`163`|`1212`|``|``|``|`10`|``|``|``|``|``|`VALENTES`|``|`4032`|``|``|`W`|`77TH`|`PL`|``|``|`WESTMINSTER`|`CO`|`800304501`|`C028`|``|`RAMIREZ`|`SANTIAGO`|``|``|`A`|``|``|``|``|``|`10456`|``|``|``|`URA`|`LN`|``|``|`NORTHGLENN`|`CO`|`802343646`|`C051`|``|`150966`|`30000`|`120966`|`M`|`M`|`M`|`12020`|`2390`|`9630`|`150966`|`30000`|`120966`|``|``|``|`1179.64`|`2011`|`20120000`|`555`|`60.0000`|`110.0000`|`.1500`|`6600`|`1814`|`L`|`1998`|`1814.00`|`1414.00`|``|`1814.00`|``|`184.00`|`1953`|`1975`|`4`|`6`|`2.00`|`2.00`|``|``|``|``|``|`ACE`|``|``|`R00`|``|`AVE`|`FRY`|`FMV`|``|``|``|``|``|``|`450`|`FA0`|``|``|``|``|`QAV`|`015`|`I00`|``|`2.00`|`000`|``|``|`1`|``|``|``|``|``|``|`SUB:VALENTES SUBD BLK:2 LOT:3`|``|``"
stringr::str_count(v, "`")
stringr::str_count(x, "\\|")
stringr::str_count(x, "`")
devtools::install_github('jbryer/DTedit')
library(RSQLite)
install.packages('RSQLite')
library(RSQLite)
library(shiny)
library(DTedit)
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
##### Load books data.frame as a SQLite database
conn <- dbConnect(RSQLite::SQLite(), "books.sqlite")
dbListTables(conn)
!'names' %in% dbListTables(conn)
if(!'names' %in% dbListTables(conn)) {
names <- data.frame(Name=character(), Email=character(), Date=character(),
Type = factor(levels=c('Admin', 'User')),
stringsAsFactors=FALSE)
dbWriteTable(conn, "names", names, overwrite = TRUE)
}
!'names' %in% dbListTables(conn)
dbListTables(conn)
getNames <- function() {
res <- dbSendQuery(conn, "SELECT * FROM names")
names <- dbFetch(res)
dbClearResult(res)
names$Date <- as.Date(names$Date)
names$Type <- as.factor(names$Type)
return(names)
}
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
data
row
query
runApp('~/git/DTedit/inst/shiny_demo')
getNames()
max(getNames()$id)
nrow(getNames())
runApp('~/git/DTedit/inst/shiny_demo')
runApp('~/git/DTedit/inst/shiny_demo')
##### Load books data.frame as a SQLite database
conn <- dbConnect(RSQLite::SQLite(), "books.sqlite")
'names' %in% dbListTables(conn)
dbGetQuery(conn, "select * from names")
dbGetQuery(conn, "drop table names")
'names' %in% dbListTables(conn)
if(!'names' %in% dbListTables(conn)) {
names <- data.frame(id=numeric(),
Name=character(),
Email=character(),
Date=character(),
Type = factor(levels=c('Admin', 'User')),
stringsAsFactors=FALSE)
dbWriteTable(conn, "names", names, overwrite = TRUE)
}
'names' %in% dbListTables(conn)
dbGetQuery(conn, "select * from names")
dbGetQuery(conn, "INSERT INTO names (id, Name, Email, Date, Type) VALUES (1, 'Aaron Schroeder', 'dads2busy@gmail.com', '11/13/1968', 'Admin' )")
dbGetQuery(conn, "select * from names")
dbGetQuery(conn, "drop table names")
dbGetQuery(conn, "select * from names")
runApp('~/git/DTedit/inst/shiny_demo')
dbGetQuery(conn, "select * from names")
dbDisconnect(conn)
file_path <- "/project/biocomplexity/sdad/projects_data/UVA_300000123123966_TaxHist01_Delivery_20190827_145cols_ascii.txt"
file_path <- "/project/biocomplexity/sdad/projects_data/UVA_300000123123966_TaxHist01_Delivery_20190827_145cols_ascii.txt"
Sys.setenv(file_path=file_path)
file_path
Sys.setenv(EXAMPLES = "example/path")
basename(file_path)
file_path <- "/project/biocomplexity/sdad/projects_data/UVA_300000123123966_TaxHist01_Delivery_20190827.txt"
file_path_no_ext <- tools::file_path_sans_ext(file_path)
file_path_no_ext
file.info(file_path)
file.path(file_path)
tools::file_ext(file_path)
col_num <- "145"
file_path <- "/project/biocomplexity/sdad/projects_data/UVA_300000123123966_TaxHist01_Delivery_20190827.txt"
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
cut_col_path
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
ascii_path
Sys.setenv(col_num=col_num)
col_delim <- "|"
Sys.setenv(col_delim=col_delim)
col_delim <- "|"
col_num <- "145"
file_path <- "/project/biocomplexity/sdad/projects_data/UVA_300000123123966_TaxHist01_Delivery_20190827_test.txt"
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
col_delim <- "|"
col_num <- "145"
file_path <- "/project/biocomplexity/sdad/projects_data/volume_nyc1_03/Biocomplexity-CoreLogic/05092019_Corelogic_Data_Delivery/UVA_300000123123966_TaxHist01_Delivery_20190827_test.txt"
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
col_delim_num <- col_num - 1
col_num <- 145
col_delim_num <- col_num - 1
Sys.setenv(col_delim_num=col_delim_num)
Sys.getenv("db_pass")
Sys.getenv("db_pwd")
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.getenv("db_usr")
col_delim <- "|"
col_num <- 145
col_delim_num <- col_num - 1
file_path <- "/project/biocomplexity/sdad/projects_data/volume_nyc1_03/Biocomplexity-CoreLogic/05092019_Corelogic_Data_Delivery/UVA_300000123123966_TaxHist02_Delivery_20190827.txt"
file_ext <- tools::file_ext(file_path)
file_path_no_ext <- tools::file_path_sans_ext(file_path)
cut_col_path <- paste0(file_path_no_ext, "_", col_num,"cols.", file_ext)
ascii_path <- paste0(tools::file_path_sans_ext(cut_col_path), "_ascii.", file_ext)
Sys.setenv(col_delim=col_delim)
Sys.setenv(col_num=col_num)
Sys.setenv(col_delim_num=col_delim_num)
Sys.setenv(file_path=file_path)
Sys.setenv(cut_col_path=cut_col_path)
Sys.setenv(ascii_path=ascii_path)
Sys.setenv(PGUSER=Sys.getenv("db_usr"))
Sys.setenv(PGPASSWORD=Sys.getenv("db_pwd"))
ascii_path
>>>>>>> 9a3e96ca8813b4656a11e8aa2ee467c6674cd943
